---
title: "GraficoTema3"
author: "Jorge García, Belén Gallego, Sergio Taengua y Mar Alemany "
date: "2024-02-28"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r, message=FALSE}
# Asegúrate que el paquete "pacman" está instalado
if (!require("pacman")) install.packages("pacman")

```

```{r}
library(ggplot2)
library(readr)
library(tinytex)
library(dplyr)
```


```{r}
covid_data <- read_csv("https://covid.ourworldindata.org/data/owid-covid-data.csv")
spec(covid_data) # IMPORTAMOS CSV

spain <- which(covid_data$location == "Spain") #SACAMOS REGISTROS DE SPAIN
united_states <- which(covid_data$location == "United States") #SACAMOS REGISTROS DE USA
italy <- which(covid_data$location == "Italy") #SACAMOS REGISTROS DE ITALY
france <- which(covid_data$location == "France") #SACAMOS REGISTROS DE FRANCE
germany <- which(covid_data$location == "Germany") #SACAMOS REGISTROS DE GERMANY
japan <- which(covid_data$location == "Japan") #SACAMOS REGISTROS DE JAPAN
canada <- which(covid_data$location == "Canada") #SACAMOS REGISTROS DE CANADA
united_kingdom <-  which(covid_data$location == "United Kingdom") #SACAMOS REGISTROS DE UK

paises <- c(canada, france, germany, italy, japan, spain, united_kingdom, united_states)
# Agrupamos todos los indices en un solo vector para poder sacarlos todos los registros que nos interesan

covid_data_ref <- covid_data[paises, c(3,4,15)] %>% subset( new_deaths_per_million > 0 )
#Recoge del data frame los valores que son mayores que 0 para que las lineas no desciendan directamente si no hay registros o el contel es 0.

#Nuevo dataframe con filas y columnas de interés
covid_data_ref_spain <- covid_data[spain, c(3,4,15)] %>% subset( new_deaths_per_million > 0 )
```


```{r}
colores <- c("Canada" = "brown", "France" = "orange", "Germany" = "green", "Italy" = "cyan", "Japan" = "blue", "Spain" = "red", "United Kingdom" = "pink", "United States" = "purple")

tamanyos <- c("Canada" = 1, "France" = 1, "Germany" = 1, "Italy" = 1, "Japan" = 1, "Spain" = 1, "United Kingdom" = 1, "United States" = 1)

ggplot(data = covid_data_ref, aes(x = date, y = new_deaths_smoothed_per_million, color = location)) + geom_line(aes(linewidth = location)) + scale_color_manual(values = colores) + scale_discrete_manual("linewidth", values = c(0.5, 0.5, 0.5, 0.5, 0.5, 1, 0.5, 0.5)) + theme_bw() + theme(panel.grid = element_blank()) + geom_hline(yintercept = c(0,5,10,15,20), linetype = "dashed", color = "grey") + labs(title = "Daily new confirmed COVID-19 deaths per million people", subtitle = "For some countries the number of confirmed deaths is much lower than the true number of deaths.", caption = "Source: Johns Hopkins University CSSE COVID-19 Data") + theme(plot.caption = element_text(hjust = 0))
```

